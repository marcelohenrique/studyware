CREATE TABLE TB_ORGAO (
	ID INTEGER PRIMARY KEY,
	SIGLA TEXT UNIQUE NOT NULL,
	NOME TEXT NOT NULL,
	DESCRICAO TEXT,
	SITE TEXT
);

CREATE TABLE TB_MATERIA (
	ID INTEGER PRIMARY KEY,
	SIGLA TEXT UNIQUE NOT NULL,
	NOME TEXT NOT NULL,
	DESCRICAO TEXT
);

CREATE TABLE TB_BANCA (
	ID INTEGER PRIMARY KEY,
	SIGLA TEXT UNIQUE NOT NULL,
	NOME TEXT NOT NULL,
	DESCRICAO TEXT
);

CREATE TABLE TB_CONCURSO (
	ID_ORGAO INTEGER REFERENCES TB_ORGAO ( ID ) NOT NULL,
	ID_BANCA INTEGER REFERENCES TB_BANCA ( ID ) NOT NULL,
	ANO INTEGER NOT NULL,
	PRIMARY KEY ( ID_ORGAO, ID_BANCA, ANO )
);

CREATE TABLE TB_CONCURSO_MATERIA (
	ID_ORGAO INTEGER NOT NULL,
	ID_BANCA INTEGER NOT NULL,
	ANO_CONCURSO INTEGER NOT NULL,
	ID_MATERIA INTEGER REFERENCES TB_MATERIA ( ID ) NOT NULL,
	TEMPO_ALOCADO INTERVAL SECOND NOT NULL,
	-- SOMA_TEMPO INTERVAL SECOND NOT NULL,
	FOREIGN KEY ( ID_ORGAO, ID_BANCA, ANO_CONCURSO ) REFERENCES TB_CONCURSO ( ID_ORGAO, ID_BANCA, ANO ),
	PRIMARY KEY ( ID_ORGAO, ID_BANCA, ANO_CONCURSO, ID_MATERIA )
);

CREATE TABLE TB_HISTORICO_ESTUDO (
	ID_ORGAO INTEGER NOT NULL,
	ID_BANCA INTEGER NOT NULL,
	ANO_CONCURSO INTEGER NOT NULL,
	ID_MATERIA INTEGER NOT NULL,
	DATA_HORA_ESTUDO TIMESTAMP NOT NULL,
	TEMPO_ESTUDADO INTERVAL SECOND NOT NULL,
	OBSERVACAO TEXT,
	FOREIGN KEY ( ID_ORGAO, ID_BANCA, ANO_CONCURSO, ID_MATERIA ) REFERENCES TB_CONCURSO_MATERIA ( ID_ORGAO, ID_BANCA, ANO_CONCURSO, ID_MATERIA ),
	PRIMARY KEY ( ID_ORGAO, ID_BANCA, ANO_CONCURSO, ID_MATERIA, DATA_HORA_ESTUDO )
);