<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="stylesheet" type="text/css" href="css/grid12col.css" />
	<script type="text/javascript">
		function disconnectUser() {
			var revokeUrl = 'https://accounts.google.com/o/oauth2/revoke?token=' + access_token;

			// Realizar uma solicitação GET assíncrona.
			$.ajax({
				type: 'GET',
				url: revokeUrl,
				async: false,
				contentType: "application/json",
				dataType: 'jsonp',
				success: function(nullResponse) {
					// Fazer algo agora que o usuário está desconectado
					// A resposta é sempre indefinida.
					logout();
				},
				error: function(e) {
					// Gerenciar o erro
					console.log(e);
					// Você pode apontar usuários para desconectar manualmente se não for bem-sucedido
					// https://plus.google.com/apps
				}
			});
		}
	</script>

	<ui:insert name="header"></ui:insert>

</h:head>
<h:body>

	<p:ajaxStatus onstart="PF('statusDialog').show();"
		onsuccess="PF('statusDialog').hide();" />

	<p:dialog modal="true" widgetVar="statusDialog" header="Carregando..."
		draggable="false" closable="false" resizable="false">
		<p:graphicImage value="/images/ajax-loader.gif" />
	</p:dialog>

	<ui:insert name="menu">

		<h:form id="formulariomenu">
			<div class="container">

				<p:menubar>

					<p:menuitem icon="ui-icon-home" action="#{controller.home()}" />

					<p:menuitem value="Estudos" icon="ui-icon-note"
						action="#{controller.consultarUsuarioEstudo()}" />

					<p:submenu label="Administração" icon="ui-icon-gear"
						rendered="#{ sessionAuth.usuario.email == 'mhguara@gmail.com' }">
						<p:menuitem value="Usuários" icon="ui-icon-person"
							action="#{controller.consultarUsuario()}" />
						<p:menuitem value="Matérias" icon="ui-icon-document"
							action="#{controller.consultarMateria()}" />
					</p:submenu>

					<f:facet name="options">
						<p:commandButton value="Logout" icon="ui-icon-extlink"
							action="#{sigin.logout()}" ajax="false" />
					</f:facet>
				</p:menubar>

			</div>
		</h:form>

	</ui:insert>

	<h:form id="formulario">

		<p:growl autoUpdate="true" showDetail="true" sticky="true" />

		<ui:insert name="main">
		</ui:insert>

	</h:form>

	<!-- <ui:debug hotkey="k"/> -->

</h:body>
</html>
